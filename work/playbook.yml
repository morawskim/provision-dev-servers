---
- hosts: localhost
  become: true
  connection: local
  tasks:
    - name: Add nodejs GPG apt Key
      apt_key:
        url: https://deb.nodesource.com/gpgkey/nodesource.gpg.key
        state: present
    - name: Add nodejs Repository
      apt_repository:
        repo: deb https://deb.nodesource.com/node_14.x {{ ansible_facts['distribution_release'] }} main
        state: present
    - name: Update apt
      apt: update_cache=yes

    - name: Install required packages CLI
      package:
        name:
          - jq
          - tmux
          - nodejs
          - npm
          - pipx
          - vim
          - whois
          - ipcalc
          - bcal
          - colordiff
          - silversearcher-ag
          - powerline
          - tmuxinator
        state: present
    - name: Install delta
      apt:
        deb: https://github.com/dandavison/delta/releases/download/0.12.1/git-delta_0.12.1_amd64.deb
    - name: Install required packages GUI
      package:
        name:
          - ghex
          - peek
          - libreoffice-l10n-pl
          - xclip
          - vim-gtk3
        state: present
    - name: Install snap packages
      snap:
        name:
          - ksnip
          - lsd
          - spotify
        state: present
    - name: Install snap classic packages
      snap:
        name:
          - helm
          - code
        classic: yes 
        state: present
    - name: Install fzf 0.29
      unarchive:
        src: https://github.com/junegunn/fzf/releases/download/0.29.0/fzf-0.29.0-linux_amd64.tar.gz
        dest: /usr/local/bin/
        remote_src: yes
    - name: Fetch fzf key-bindings for bash
      get_url:
        url: https://raw.githubusercontent.com/junegunn/fzf/master/shell/key-bindings.bash
        dest: /etc/bash_completion.d/fzf-key-bindings.bash
        mode: '0444'
